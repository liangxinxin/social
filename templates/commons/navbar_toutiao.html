
{% macro macro_body_navbar() -%}
<div class="masthead clearfix">
  <div class="inner">

    <nav>
      <div id="navbar" class="navbar-collapse collapse">
        <h2 class="masthead-brand">财经头条</h2>
        <ul class="nav masthead-nav">
          <li class="active"><a href="http://0.0.0.0:5100/index">资讯</a></li>
          <li><a href="/community_index">社区</a></li>
        </ul>

        <ul class="nav navbar-nav navbar-right">
          <li class="dropdown">
            {% if session.get('userinfo') %}
            <a href="#" class="dropdown-toggle" style="background: transparent;" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="icon-user"></i>{{ session.get('userinfo')['name'] }}<span class="caret"></span></a>
            <ul class="dropdown-menu dropdown-menu-right">
              <li><a href="#">个人主页</a></li>
              <li><a href="#">设置</a></li>
              <li><a href="javascript:to_log_out()">登出</a></li>
            </ul>
            {% else %}
            <a href="#" class="dropdown-toggle" style="background: transparent;" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">未登陆 <span class="caret"></span></a>
            <ul class="dropdown-menu dropdown-menu-right">
              <li><a href="javascript:to_log_in()">登陆</a></li>
              <li><a href="javascript:to_regist()">注册</a></li>
            </ul>
            {% endif %}
          </li>
        </ul>

        <div class=" nav masthead-nav navbar-form navbar-right">
          <div class="form-group has-feedback">
            <input type="text" class="form-control" id="search_input" placeholder="Search" onkeypress="if(event.keyCode==13) {search()}">
            <span class="glyphicon glyphicon-search form-control-feedback" />
          </div>
        </div>

      </div>
    </nav>
  </div>
</div>

<script type="text/javascript" >
 function to_log_in() {
     var cur_url=this.location.href;
     window.location.href="/login?next_url="+cur_url;
 }
 function to_regist() {
     var cur_url=this.location.href;
     window.location.href="/user_create?next_url="+cur_url;
 }
 function to_log_out() {
     var cur_url=this.location.href;
     window.location.href="/logout?next_url="+cur_url;
 }
</script>
{%- endmacro %}
