{% extends 'commons/_proto.html' %}

{% block body %}

{% include 'commons/navbar_toutiao.html' %}

<div class="singup-wrap">
<div id="create_user_wrap" class="row div-signup">
  <form id="create_user_info">
<!--    <h3 class="form-signup-heading">新用户注册</h3> -->
    <div id="user_password_div" class="form-group row">
      <label class="col-sm-3 col-form-label">密码：</label>
      <div class="col-sm-6">
        <input type="password" id="user_password_input" class="form-control"/>
      </div>
    </div>

    <div id="user_password_div" class="form-group row">
      <label class="col-sm-3 col-form-label">重复密码：</label>
      <div class="col-sm-6">
        <input type="password" id="user_password_input_repeat" class="form-control"/>
      </div>
    </div>

    <div id="user_name_div" class="form-group row">
      <label class="col-sm-3 col-form-label" for="user_name_input">名字(昵称)：</label>
      <div class="col-sm-6">
        <input type="text" id="user_name_input" class="form-control"/>
      </div>
    </div>

    <div id="user_create" class="form-group row col-sm-6 col-sm-offset-3 signup-submit-div">
      <button onclick="return create_user()" class="btn btn-primary btn-lg btn-block">完成注册</button>
    </div>
  </form>
</div>
</div>

<script type="text/javascript">
 function post(URL, PARAMS) {
     var temp = document.createElement("form");
     temp.action = URL;
     temp.method = "post";
     temp.style.display = "none";
     for (var x in PARAMS) {
         var opt = document.createElement("textarea");
         opt.name = x;
         opt.value = PARAMS[x];
         temp.appendChild(opt);
     }
     document.body.appendChild(temp);
     temp.submit();
     return temp;
 }
 function create_user() {
     var name= document.getElementById("user_name_input").value;
     var password = document.getElementById("user_password_input").value;
     var password_repeat = document.getElementById("user_password_input").value;
     if (name == "") {
         alert("请输入昵称");
         return;
     }
     if (password == "") {
         alert("请输入密码");
         return;
     }
     if (password_repeat == "") {
         alert("请重复输入密码");
         return;
     }
     var data={};
     data['type']='publish';
     data['name']=name;
     data['password']=password;
     {% if session.get('user_info') %}
     data['mobile']={{session.get('user_info')['mobile']}};
     {% endif %}
     $.ajax({
         type:'POST',
         url:'/do_user_create',
         data:data,
         dataType:'json',
         success:function(data) {
             //alert('恭喜注册成功!您可以用手机号或者昵称登录！');
             window.location.href="/index";
         },
         error:function(xhr,type) {
             alert('create user fail!');
         }
     });
     return false;
 }
</script>
{% endblock %}
