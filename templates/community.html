{% extends 'commons/_proto.html' %}
{% from 'commons/navbar_toutiao.html' import macro_body_navbar %}

{% block head %}
    <link rel="stylesheet" type="text/css" href="stylesheets/community/community_home.css">
{% endblock %}

{% block body %}
    <div id="navbar">
    	{{ macro_body_navbar() }}
    </div>
    <input id="community_id" style="display:none" value={{community_id}}></input>
    <div id="all_backgroud" style="height:1500px; background:#FFF">
        <div id="community_wrapper" style="width:70%;text-align:center;margin:0 auto">
            <div id="community_head" class="card_top_wrap">
                <div id="community_head_left" class="card_info">
                    <div id="community_img" class="card_image">
                        <a>
                            <img class src="https://img3.doubanio.com/icon/g35417-1.jpg">
                        </a>
                    </div>
                    <div id="community_title" class="card_title">
                       <a class="card_title_name" title="" href="/f?kw=%E5%AE%9C%E4%BF%A1&amp;ie=utf-8">宜信岛</a>
                       <span class="card_num_wrap">
                           <span class="card_num_label">关注：</span>
                           <span class="card_num">10,838</span>
                           <span class="card_num_label">贴子：</span>
                           <span class="card_num">40,565</span>
                       </span>
                    </div>
                </div>
            </div>
            <div id="community_post" style="text-align:left; height:auto; background:#FFF">
                {% if object_list %}
                    {%for post in object_list%}
                        <div class="post_item_wrap">
                            <div class="post_item">
                                <div class="post_user_face">
                                    <a>
                                        <img class src="https://img3.doubanio.com/icon/u150496187-25.jpg">
                                    </a>
                                </div>
                                <div class="post_content_wrap">
                                    <div class="post_title">
                                       <a class="post_title_font" href="http://127.0.0.1:5100/post?post_id={{post.id}}">{{post.title|safe}}</a>
                                    </div>
                                    <div class="post_content">
                                        <a style="color:inherit" href="http://www.baidu.com"><p>{{post.content|safe}}</p></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {%endfor%}
                {% endif %}
            </div>
            <div id="publish_post" class="poster_container">
                <div id="publish_post_header" class="poster_header">
                   <a class="post_header_info">发表新贴</a>
                </div>
                <div id="div_publish_post_title" class="poster_title">
                    <input id="input_publish_post_title" type="text" style="width:300px" />
                </div>
                <div id="div_publish_post_content" class="poster_content">
                    <input id="input_publish_post_content" type="text" style="width:300px;height:290px" />
                </div>
                <div id="div_button_publish_post" class="poster_publish_container">
                    <button id="button_publish_post" onclick='publish_post()'> 发新帖</button>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
         //var obj=document.getElementById("button_publish_post");
         //obj.onclick=function() {
         //  publish_post();
         //}
         function publish_post() {
           //get title
           var title=document.getElementById("input_publish_post_title").value;
           //get content
           var content=document.getElementById("input_publish_post_content").value;
           var id=document.getElementById("community_id").value;
           //post request for save post
           post("/post_publish",{"type":"publish","title":title,"content":content,"create_user_id":1,"community_id":id});
         }
         function post(URL, PARAMS) {        
             var temp = document.createElement("form");        
             temp.action = URL;        
             temp.method = "post";        
             temp.style.display = "none";        
             for (var x in PARAMS) {        
                 var opt = document.createElement("textarea");        
                 opt.name = x;        
                 opt.value = PARAMS[x];        
                 temp.appendChild(opt);        
             }     
             document.body.appendChild(temp);        
             temp.submit();        
             return temp;        
         }     
         function search() {
             post("/search",{"query":document.getElementById("search_input").value});
         }
        // function pre_page(page_no) {
        //     window.location="/search_result?page_no="+({{page_no}}-1).toString();
        // }
        // function next_page(page_no) {
        //     window.location="/search_result?page_no="+({{page_no}}+1).toString();
        // }
    </script>
{% endblock %}
